# scikit-learn を使った顧客離脱の予測
このリポジトリは、[Telco Churn のための視覚的なモデル解釈可能性](https://blog.cloudera.com/visual-model-interpretability-for-telco-churn-in-cloudera-data-science-workbench/)というブログ記事に付随するものであり、Cloudera Machine Learning (CML) 上でプロジェクトの成果物をすべて構築するために必要なコードを含んでいます。さらに、このプロジェクトは、自由にダウンロードできる Cloudera Fast Forward の [解釈可能性に関するレポート](https://ff06-2020.fastforwardlabs.com/)で議論されている概念の実用的な例としても役立ちます。

![テーブルビューの画像](images/table_view.png)

このリポジトリの**主な目的**は、架空の電気通信会社から**顧客グループが解約する確率を予測する**ためのロジスティック回帰分類モデルを構築することです。加えて、[LIME（Local Interpretable Model-agnostic Explanations）](https://github.com/marcotcr/lime)と呼ばれる手法を用いてモデルが解釈されています。ロジスティック回帰モデルと LIME モデルはともに、Cloudera AI のリアルタイムなモデルデプロイメント利用し、 Flask ベースの Web アプリケーションとしてデプロイされます。このアプリでは、ユーザーが画面からモデルを操作し、**データ内のどの要因が顧客の解約確率に最も影響を与えているか**を確認できます。

## プロジェクトの構成

プロジェクトは、以下のフォルダ構造となっています。

```
.
├── code/              # バックエンドのスクリプトや、対話的な分析をするためのノートブックファイル
├── flask/             # 最終的にデプロイする flask のアプリに必要なアセット
├── images/            # プロジェクトのドキュメントが利用する画像
├── models/            # 学習済みモデルを保持するためのディレクトリ
├── raw/               # プロジェクト内で使用される生の（加工前の）データファイル
├── cdsw-build.sh      # 環境構築用のスクリプト
├── model_metrics.db   # モデルドリフトのメトリクス（指標）を保存するために使用される SQLite データベース
├── README.md
└── requirements.txt 
```

`code` ディレクトリ内のノートブック、スクリプト、およびドキュメントの手順に従うことで、Cloudera AI 上で同様の分類タスクを実行する方法、およびプラットフォームの主要な機能を活用する方法を理解できます。
たとえば、以下のような機能です。 

- Spark を使用したデータの取り込み（データ収集）と操作
- 効率的なモデル開発と実験
- RESTful API エンドポイントによるモデルのデプロイ
- 機械学習アプリケーションのホスティング
- モデルガバナンスやモデルパフォーマンスメトリクスの追跡を含むモデル運用（ModelOps）

私たちは Cloudera AI 内での作業に焦点を当て、データサイエンスで標準的に使うコードの詳細については割愛します。

このプロジェクトを **Applied ML Prototype (AMP)** としてデプロイした場合、すべてがすでにインストールされているため、[このドキュメント](code/README.md)に概説されているセットアップ手順を実行する必要はありません。
ただし、ドキュメントとそれに対応するファイルを確認すること、特に `code/2_data_exploration.ipynb` および `code/3_model_building.ipynb` を Jupyter Notebook セッションで実行して、最終モデルの作成に情報を提供したプロセスを確認しておくと、学習上役に立つかもしれません。
自動化なしで、ソースコードからこのプロジェクトを構築する場合は、[このドキュメント](code/README.md)に記載されている手順に**注意深く、順番に**従う必要があります。
